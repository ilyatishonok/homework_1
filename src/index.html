<html>
    <head>
        <title>Canvas DnD</title>
        <link rel="stylesheet" type="text/css" href="styles.css">
    </head>
    <body>
        <div class="layout" style="position: relative">
                <div class="figures-bar" draggable="false">
                        <div draggable="false" class="circle"></div>
                        <div draggable="false" class="rect"></div>
                </div>
                <div class="canvas-area">
                    <h1>Canvas</h1>
                    <div class="canvas-wrapper">
                        <canvas height="250px" width="250px" style="margin: 0;padding: 0" id="canvas"></canvas>
                    </div>
                </div>
        </div>
        <script src="./lib/dragger.js"></script>
        <script src="./lib/Draggable/index.js"></script>
        <script src="./lib/Droppable/index.js"></script>
        <script src="./canvas/circle.js"></script>
        <script src="./canvas/rect.js"></script>
        <script src="./canvas/index.js"></script>
        <script>
            const { ctx, canvas, canvasObjects } = canvasHandler;

            const circle = new Draggable(document.querySelector('.circle'), {
                createAvatar: element => {
                    const clonedNode = element.cloneNode(true);

                    return clonedNode;
                },
                onDragStart: (element) => {
                    element.style.background = 'gray';
                    element.style.border = '1px solid white';
                },
                onDragCancel: element => {
                    element.style.background = 'red';
                    element.style.border = '';
                },
                onDragEnd: element => {
                    element.style.background = 'red';
                    element.style.border = '';
                }
            });

            const rect = new Draggable(document.querySelector('.rect'), {
                createAvatar: element => {
                    const clonedNode = element.cloneNode(true);

                    return clonedNode;
                },
                onDragStart: element => {
                    element.style.background = 'gray';
                    element.style.border = '1px solid white';
                },
                onDragCancel: element => {
                    element.style.background = 'red';
                    element.style.border = '';
                },
                onDragEnd: element => {
                    element.style.background = 'red';
                    element.style.border = '';
                }
            });

            const droppable = new Droppable(document.querySelector('#canvas'), {
                onDragEnd: (draggableElement, event) => {
                    const rect = canvas.getBoundingClientRect();
                    if (draggableElement.classList.contains('circle')) {
                        const newCircle = new Circle(
                            event.clientX - rect.left,
                            event.clientY - rect.top,
                            draggableElement.clientHeight
                        );

                        canvasObjects.push(newCircle);
                        newCircle.draw(ctx);
                    } else if (draggableElement.classList.contains('rect')) {
                        const newRect = new Rect(
                            event.clientX - rect.left,
                            event.clientY - rect.top,
                            draggableElement.clientWidth,
                            draggableElement.clientHeight
                        )

                        canvasObjects.push(newRect);
                        newRect.draw(ctx);
                    }
                }
            });
        </script>
    </body>
</html>